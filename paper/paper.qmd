---
title: "Mental Health Plays Significant Role in Physical Wellness"
subtitle: "Intersectionality and Mental Illness Being Overlooked in the Medical Field"
author: 
  - Mingjia Chen
thanks: "Code and data are available at: https://github.com/MjChen120/Mental_to_Physical_Health.git."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#download the packages if necessary, then load the packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load(janitor,here,dplyr,tidyverse,knitr,kableExtra,ggplot2,arrow)

library(janitor)
library(tidyverse)
library(knitr)
library(dplyr)
library(kableExtra)
library(here)
library(ggplot2)
library(arrow)


#### Load data ####
GSS <- read_parquet(here::here("data/analysis_data/cleaned_GSS.parquet"))
demo_data <- read_parquet(here::here("data/analysis_data/demo_data.parquet"))
days_data <- read_parquet(here::here("data/analysis_data/days_data.parquet"))
analysis_data <- read_parquet(here::here("data/analysis_data/analysis_data.parquet"))
mentalVsHealth <- read_parquet(here::here("data/analysis_data/mentalVsHealth_data.parquet"))
```


# Introduction {#sec-intro}

Mental health is one essential aspect of the general health of an individual and yet it is often overlooked in the past centuries. Mental illnesses are not only “silent diseases” of one’s mind, but could as well impact patients’ physical well-being in general [@Ohrnberger_Fichera_Sutton]. As browsing through relevant journal articles, a question arises: could mental health-related and demographic factors impact the number of days an individual experiences physical unwellness in a month?

U.S. General Social Survey (GSS) data is used for this paper to examine whether the demographic and mental health-related factors as indicators of physical health conditions. The estimand is the difference in whether an individual could experience more occasions of feeling physically unwell if they have mental health unwellness versus not. This is considered in terms of those who were diagnosed as having depression by a doctor.

The analysis of GSS data, including gender, age, and mental and physical health variables, seeks to provide detailed insights into how mental health issues impact physical unwellness, contributing to discussions on intersectionality and overlooked mental health in the medical field.

<Results paragraph>

This paper begins with [Introduction] framing the impact of mental health on one's well-being. The [Data] section details variables, methodology, and analysis cleaning processes. In the [Model] section, a model is proposed for determining how an individual's depression status and counted days of mental unwellness in the past 30 days impact their counted days of physical unwellness in the past 30 days. [Results] section analyzes how demographic and other mental health-related factors would affect physical health with model calculations, leading the [Discussion] section with gender intersectionality and mental health issues often being overlooked in the medical field. Limitations and Future Research sections are included for study limitations and future research directions. The [Appendix] provides further survey information.

# Data {#sec-data}

The paper uses data collected from the US General Social Survey (GSS) from NORIC at the University of Chicago [@GSS]. From the dataset, this paper focuses specifically on variables related to demographic backgrounds, mental health, and physical health, from 1992 to 2022. This longitudinal approach allows us to analyze whether an individual's demographic factors and mental health well-being could significantly contribute to their physical well-being.

## Source Data

The data was downloaded and filtered for the selected variables from the selected data variables from GSS[^1]. The data cleaning was performed based on value definitions as defined in the GSS codebooks [@gssCodebook]. The variable names are renamed to be more informative (@tbl-use-var).


| Variable | New Name  | Description                   | Example |
|----------|-----------|-------------------------------|---------|
| ID_      | id        | Response ID                   | 1       |
| YEAR     | year      | Year of the Data Recorded     | 1977    |
| SEX      | sex       | Respondent's gender           | Female/2|
| AGE      | age       | Respondent's age              | 25      |
| HEALTH   | health    | Respondents' health condition | Good/2  |
| PHYSHLTH | phys_days | Days of Respondents' physical health being not good   | 15      |
| MNTLHLTH | ment_days | Days of Respondents' mental health being not good     | 20      |
| DEPRESS  | depress   | Whether respondents have been told having depression  | Yes/1   |


: Source data retrieved from GSS {#tbl-use-var}

## Data Cleaning

The data was cleaned by using the open source statistically programming language R [@citeR], with libraries `tidyverse` [@tidyverse], `ggplot2` [@ggplot2], `dplyr` [@dplyr], `readr` [@readr], `tibble` [@tibble], `here` [@here], `kableExtra` [@kableExtra], `janitor` [@janitor], `arrow` [@arrow], and `knitr` [@knitr].

[^1]: https://gss.norc.org/documents/stata/GSS_stata.zip


## Survey Methodology

some words

## Demographic Variables 
```{r}
#| label: tbl-demo-overview
#| tbl-cap: Overview of the Demographic Data 
#| echo: false
#| warning: false
#| message: false

vars <- c("ID","Gender","Age","Physical Unwellness","Mental Unwellness","Age Cohort")

kable(head(demo_data), 
      caption = "Counted days of Physical and Mental unwellness of Population by Age and Gender Groups", 
      align = "c",
      col.names = vars,
      row.names = FALSE) |>
  kable_styling(latex_options = c("striped", "hold_position"), bootstrap_options = "striped", full_width = FALSE)
```

## Mental and Physical Unwellness and Depression Diagnosis
```{r}
#| label: tbl-analysis-vars
#| tbl-cap: Overview of the Main Analysis Dataset
#| echo: false
#| warning: false
#| message: false

vars <- c("ID","Physical Unwellness","Mental Unwellness","Depression Diagnosis")

kable(head(analysis_data), 
      caption = "Counted days of Physical and Mental unwellness with Depression Diagnosis", 
      align = "c",
      col.names = vars,
      row.names = FALSE) |>
  kable_styling(latex_options = c("striped", "hold_position"), bootstrap_options = "striped", full_width = FALSE)
```

## Mental Unwellness and General Health Status
```{r}
#| label: tbl-health-vars
#| tbl-cap: Overview of the Mental Unwellness vs. General Health Status Dataset 
#| echo: false
#| warning: false
#| message: false

vars <- c("ID","Mental Unwellness","General Health")

kable(head(mentalVsHealth), 
      caption = "Counted days of Mental unwellness with General Health Status", 
      align = "c",
      col.names = vars,
      row.names = FALSE) |>
  kable_styling(latex_options = c("striped", "hold_position"), bootstrap_options = "striped", full_width = FALSE)
```

## Non-response Rate

```{r}
#| label: fig-nonresponse-rate
#| fig-cap: Nonresponse Rates
#| echo: false
#| warning: false
#| message: false

# record number of non-responses in variables ment_days, phys_days, and depress
no_response_data <- rep(0,3)

#length(which(<condition>)) code referenced from https://www.geeksforgeeks.org/count-repeated-values-in-r/
no_response_data <- c(length(which(GSS$phys_days<1)),length(which(GSS$ment_days<1)),length(which(GSS$depress<1)))

# calculate the percentages
total_responses <- nrow(GSS)
non_response_rate <- no_response_data/total_responses 
non_response_rate <- round(non_response_rate,3)
questions <- c("Physical Unwellness","Mental Unwellness","Depression Status")
non_response_data <- cbind(questions,non_response_rate)
  
ggplot(non_response_data, aes(x = questions,y=non_response_rate)) +
  geom_bar(stat = "identity",fill = "skyblue") +
  theme_minimal() +
  labs(title = "Non-Response Rates of each Question", x = "Questions", y = "Percentage of Non-Responses") 

```

As shown in @fig-nonresponse-rate, some of the questions in the dataset are not included resulting no responses collected in certain years due to the change in survey methodology. This fact requires extra attention when cleaning and handling since the number of available responses will decrease when additional variables are added. Hence, an additional sub set of the data that only includes counted days of mental and physical un-wellness in the past 30 days (@tbl-sub-vars) is also included for only speculating these two variables while keeping as many responses as possible. 

```{r}
#| label: tbl-sub-vars
#| tbl-cap: Overview of the Mental and Physical Unwellness
#| echo: false
#| warning: false
#| message: false

vars <- c("ID","Physical Unwellness","Mental Unwellness")

kable(head(days_data), 
      caption = "Counted days of Mental unwellness with General Health Status", 
      align = "c",
      col.names = vars,
      row.names = FALSE) |>
  kable_styling(latex_options = c("striped", "hold_position"), bootstrap_options = "striped", full_width = FALSE)
```

# Model
The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of days that an individual feel physically unwell in the past 30 days. Then $\beta_i$ is the number of days that this individual feel mentally unwell and $\gamma_i$ indicates whether the individual is diagnosed as depressive by a doctor. $y_i$ and $\beta_i$ are measured in days.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification


# Results {#sec-results}

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| warning: false
#| message: false

#categorize the range of days for visualizing the histogram of demographic variables

demo_data <- within(demo_data, {   
  ment_range <- NA # need to initialize variable
  ment_range[ment_days < 10] <- "0-10"
  ment_range[ment_days >= 10 & ment_days < 20] <- "10-20"
  ment_range[ment_days >= 20 & ment_days < 30] <- "20-30"
} )

demo_data <- within(demo_data, {   
  phys_range <- NA # need to initialize variable
  phys_range[phys_days < 10] <- "0-10"
  phys_range[phys_days >= 10 & phys_days < 20] <- "10-20"
  phys_range[phys_days >= 20 & phys_days < 30] <- "20-30"
} )
```

```{r}
#| label: fig-demo-mental
#| fig-cap: Female Participants from 20 to 59 Years Old are More likely to Experience Mental Unwellness 
#| fig-subcap: ["Gender","Age cohorts"]
#| layout-ncol: 2
#| echo: false
#| warning: false
#| message: false


demo_data |>
  ggplot(aes(x = ment_days, fill = sex)) +
  geom_histogram(position = "dodge") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Days of Feeling Unwell Mentally in Last 30 days",
    y = "Occurrences",
    fill = "Sex"
  )

demo_data |>
  ggplot(aes(x = ment_days, fill = age_cohort)) +
  geom_histogram(position = "dodge") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Days of Feeling Unwell Mentally in Last 30 days",
    y = "Occurrences",
    fill = "Age Cohorts"
  )

```
\break

```{r}
#| label: fig-demo-physical
#| fig-cap: Female Participants from 20 to 59 Years Old are More likely to Experience Physical Unwellness 
#| fig-subcap: ["Gender","Age cohorts"]
#| layout-ncol: 2
#| echo: false
#| warning: false
#| message: false


demo_data |>
  ggplot(aes(x = phys_days, fill = sex)) +
  geom_histogram(position = "dodge") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Days of Feeling Unwell Physically in Last 30 days",
    y = "Occurrences",
    fill = "Sex"
  )

demo_data |>
  ggplot(aes(x = phys_days, fill = age_cohort)) +
  geom_histogram(position = "dodge") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Days of Feeling Unwell Physically in Last 30 days",
    y = "Occurrences",
    fill = "Age Cohorts"
  )

```
\break

Include some research about female having trouble due to medical racism etc. and possible reason why these age cohorts are more likely to experience both physical and mental unwellness.

## Depression Playing an Role
```{r}
#| label: fig-mental-vs-physical
#| fig-cap: Counts of Days Feeling Unwell in Last 30 Days
#| echo: false
#| warning: false
#| message: false


#Graph
analysis_data|>
  ggplot(aes(x = ment_days, y = phys_days, color = depress)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(x = "Mental Unwellness", y = "Physical Unwellness", color = "Depress") +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")
```
\break

## Mental Health and Health in General
```{r}
#| label: fig-mental-vs-general
#| fig-cap: Counts of Days Feeling Unwell in Last 30 Days
#| echo: false
#| warning: false
#| message: false

#Graph
mentalVsHealth|>
  ggplot(aes(x = ment_days, y = health)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_minimal() +
  labs(x = "Mental Unwellness", y = "General Health") +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")
```
\break

## Model Results
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

first_model <-
  readRDS(file = here::here("models/first_model.rds"))
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary::modelsummary(
  list(
    "First model" = first_model
  ),
  statistic = "mad",
  fmt = 2
)
```


# Discussion {#sec-discussion}

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix 

## Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

pp_check(first_model) +
  theme_classic() +
  theme(legend.position = "bottom")

posterior_vs_prior(first_model) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom") +
  coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

plot(first_model, "trace")

plot(first_model, "rhat")
```



\newpage



# References


